$def with (schemaname, servicename, servicedesc, parameters, header, footer)
$ inparams = [p for p in parameters if (p['mode'] == 'IN')]                          #get a list of all of the input parameters
$ outparams = [p for p in parameters if (p['mode'] == 'OUT')]						 #get a list of all of the output parameters

$def getqueryparams(params, queryparams):
	$for param in params:
		$ value = "1"
		$if (param['name'] in ['country_id','countryid']):
			$ value = "458"
		$elif (param['name'] in ['wdpa_id','wdpaid']):
			$ value = "785" 
		$elif (param['name'] in ['iucn_species_id','species_id','speciesid']):
			$ value = "17975"
		$elif (param['name'] in ['ecoregionid']):
			$ value = "10122"
		$if (param['type']=='array'):
			$ queryparams.append(param['name'] + "=(1,2)")
		$else:
			$ queryparams.append(param['name'] + "=" + value)
	
<html>
	<head>
		<title>DOPA Web Services</title>
		<link rel="stylesheet" type="text/css" href="../../../styles/styles.css" />
	</head>
	<body>
		$:header
		<h2><a href="../../services/">Schemas</a> | <a href="../$schemaname/">$schemaname[:1]$schemaname[1:2].upper()$schemaname[2:] Schema</a> | $servicename Service</h2>
		<table class="table" cellspacing="0"><a><tr><th>Service</th><th colspan="4">Description</th></tr>
		<tr><td>$servicename</td><td colspan="4">$:servicedesc</td></tr>
		
		$if inparams:
			<tr><td></td><th colspan="4">Input Parameters</th></tr>
			<tr><td></td><td class="smallth" style="min-width: 100px">Name</td><td class="smallth">Description</td><td class="smallth" style="min-width: 140px">Type</td><td class="smallth" style="min-width: 60px">Default</td></tr>
				
			$for inparam in inparams:
				$if inparam['default']=='':
					<tr><td></td><td>$inparam['name']</td><td>$:inparam['description']</td><td>$inparam['type']</td><td>$:inparam['default']</td></tr>
				$else:
					<tr><td></td><td><i>$inparam['name']</i></td><td>$:inparam['description'] (optional)</td><td>$inparam['type']</td><td>$:inparam['default']</td></tr>
			<tr><td></td><td><i>format</i></td><td>The reponse format (optional)</td><td>string (json | array | xml)</td><td>json</td></tr>
			$if outparams:
				<tr><td></td><td><i>fields</i></td><td>The list of fields to be returned - these must be one or more of the output parameters listed below (optional)</td><td>array</td><td>(*)</td></tr>
			<tr><td></td><td><i>includemetadata</i></td><td>Sets whether to include a metadata section in the  response which includes summary information about the results (optional)</td><td>string (true | false)</td><td>true</td></tr>
			<tr><td></td><td><i>jsoncallback</i></td><td>The name of a javascript function to call when the service call returns asynchronously (optional)</td><td>string</td><td>''</td></tr>
		
		$if outparams:		
			<tr><td></td><th colspan="4">Output Parameters</th></tr>
			<tr><td></td><td class="smallth">Name</td><td class="smallth">Description</td><td class="smallth" colspan="2">Type</td></tr>

			$for outparam in outparams: 
				<tr><td></td><td>$outparam['name']</td><td>$:outparam['description']</td><td colspan="2">$outparam['type']</td></tr>
			
		$if servicename[:3]=='get':
			<tr><td></td><th colspan="4">Example calls</th></tr>
				
			$ querystring = "?"
			$ mandatoryquerystring = "?"
			$if len(inparams)!=0:
				$ queryparams = []
				$# build the mandatory parameters for the query string
				$ getqueryparams([p for p in inparams if (p['default']== '')], queryparams)
				$ mandatoryquerystring = "?" + "&".join([param for param in queryparams])
				$# build the optional parameters for the query string
				$ getqueryparams([p for p in inparams if (p['default']!= '')], queryparams)
				$ querystring = "?" + "&".join([param for param in queryparams])
			$if mandatoryquerystring!='?':		
				<tr><td></td><td colspan="4"><a href='$mandatoryquerystring' target='__examplecall' title="Example call" class="example">$mandatoryquerystring</a></td></tr>
			$if len(mandatoryquerystring)!=len(querystring):
				<tr><td></td><td colspan="4"><a href='$querystring' target='__examplecall' title="Example call" class="example">$querystring</a></td></tr>
			$if querystring!='?': 
				$ prefix = querystring + '&' 
			$else:
				$ prefix = querystring
			<tr><td></td><td colspan="4"><a href='$(prefix)format=xml' target='__examplecall' title="Example call" class="example">$(prefix)format=xml</a></td></tr>
			<tr><td></td><td colspan="4"><a href='$(prefix)format=array&includemetadata=false' target='__examplecall' title="Example call" class="example">$(prefix)format=array&includemetadata=false</a></td></tr>
			$if (len(outparams)>0):
				<tr><td></td><td colspan="4"><a href='$(prefix)format=json&fields=($outparams[0]['name'])' target='__examplecall' title="Example call" class="example">$(prefix)format=json&fields=($outparams[0]['name'])</a></td></tr>
		</table>
		
		$:footer		
	</body>
</html>